# GoWork 3D模型生成平台 - 前端架构设计文档

## 1. 项目概述

### 1.1 项目简介
GoWork 是一个基于 AI 的 3D 模型生成平台，支持文字描述和图片输入两种方式生成 3D 模型。用户可以实时预览、编辑和导出生成的 3D 模型。

### 1.2 技术栈
- **框架**: Vue 3 (Composition API)
- **构建工具**: Vite 7.0.6
- **UI 组件库**: Element Plus 2.11.3
- **3D 渲染**: Three.js 0.180.0
- **状态管理**: Pinia 3.0.3
- **路由管理**: Vue Router 4.5.1
- **HTTP 客户端**: Axios 1.12.2
- **工具库**: @vueuse/core 13.9.0
- **开发工具**: ESLint + Prettier

### 1.3 浏览器兼容性
- 支持现代浏览器 (Chrome 90+, Firefox 88+, Safari 14+, Edge 90+)
- 需要 WebGL 支持用于 3D 渲染

## 2. 项目结构

```
web/
├── public/                     # 静态资源
│   ├── favicon.ico
│   └── models/                 # 3D模型文件
│       └── gltf/
├── src/                        # 源代码
│   ├── api/                    # API 接口层
│   ├── assets/                 # 静态资源
│   ├── components/             # 组件
│   ├── config/                 # 配置文件
│   ├── router/                 # 路由配置
│   ├── stores/                 # 状态管理
│   ├── utils/                  # 工具函数
│   ├── App.vue                 # 根组件
│   └── main.js                 # 入口文件
├── .env.development            # 开发环境配置
├── .env.production             # 生产环境配置
├── package.json                # 项目依赖
├── vite.config.js              # Vite 配置
└── README.md                   # 项目说明
```

## 3. 架构设计

### 3.1 整体架构
```
┌─────────────────────────────────────────────────────────────┐
│                        用户界面层                            │
├─────────────────────────────────────────────────────────────┤
│  AppHeader  │  LeftNav  │  CenterWorkspace  │  RightColumn  │
├─────────────────────────────────────────────────────────────┤
│                        业务逻辑层                            │
├─────────────────────────────────────────────────────────────┤
│    状态管理(Pinia)    │    路由管理(Vue Router)             │
├─────────────────────────────────────────────────────────────┤
│                        数据访问层                            │
├─────────────────────────────────────────────────────────────┤
│      API接口层(Axios)     │     本地存储(LocalStorage)      │
├─────────────────────────────────────────────────────────────┤
│                        基础设施层                            │
├─────────────────────────────────────────────────────────────┤
│   HTTP请求拦截器  │  主题管理  │  工具函数  │  3D渲染引擎    │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 组件架构
采用组合式 API 和单文件组件 (SFC) 架构，实现组件的高内聚、低耦合。

## 4. 核心模块规格

### 4.1 应用入口模块 (main.js)

**功能职责:**
- 应用初始化
- 插件注册 (Pinia, Vue Router, Element Plus)
- 全局组件注册
- 主题系统初始化

**关键代码:**
```javascript
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import ElementPlus from 'element-plus'
import * as ElementPlusIconsVue from '@element-plus/icons-vue'

const app = createApp(App)
app.use(createPinia())
app.use(router)
app.use(ElementPlus)

// 注册所有图标
for (const [key, component] of Object.entries(ElementPlusIconsVue)) {
  app.component(key, component)
}
```

### 4.2 根组件模块 (App.vue)

**功能职责:**
- 应用布局管理
- 组件间通信协调
- 模型生成事件处理

**组件结构:**
```vue
<template>
  <el-container class="app-container">
    <AppHeader />
    <el-container class="main-container">
      <LeftNav />
      <CenterWorkspace :model-id="modelId" />
      <RightColumn @model-generated="handleModelGenerated" />
    </el-container>
  </el-container>
</template>
```

**数据流:**
- 接收 RightColumn 的 `model-generated` 事件
- 将 modelId 传递给 CenterWorkspace 组件

### 4.3 顶部导航模块 (AppHeader.vue)

**功能职责:**
- 应用标题显示
- 主题切换控制
- 用户操作入口

**主要功能:**
- 暗黑/亮色主题切换

### 4.4 左侧导航模块 (LeftNav.vue)

**功能职责:**
- 导航菜单管理
- 侧边栏折叠控制

**主要功能:**
- 可折叠的侧边栏
- 导航项管理

### 4.5 中央工作区模块 (CenterWorkspace.vue)

**功能职责:**
- 3D 模型预览和渲染
- 模型操作工具栏
- 模型导出

**主要功能:**

```javascript
// 核心功能
- 3D 模型加载和显示
- 缩放控制 (放大/缩小/重置)
- 光照强度调节
- 网格显示切换
- 统计信息显示
- 模型导出下载
- 模型可见性控制
```

**技术特性:**
- 集成 ThreeScene 组件进行 3D 渲染
- 支持模型轮询加载状态
- 实时响应暗黑模式切换
- 模型生成进度显示

**关键接口:**
```javascript
// Props
modelId: Number  // 当前模型ID

// 主要方法
exportModel()    // 导出模型
printModel()     // 打印模型
zoomIn/Out()     // 缩放控制
toggleVisibility() // 切换可见性
```

### 4.6 右侧控制面板模块 (RightColumn.vue)

**功能职责:**
- AI 模型生成控制
- 输入方式切换 (文字/图片)
- 生成参数配置
- 资产库管理

**主要功能:**
```javascript
// 模型生成
- 文字描述生成 3D 模型
- 图片上传生成 3D 模型
- 风格选择和参数配置
- 生成进度监控

// 资产管理
- 历史模型浏览
- 模型预览和下载
- 资产搜索和筛选
- 模型导入功能
```

**技术特性:**
- 支持图片拖拽上传
- 实时生成进度显示
- 资产轮询更新机制
- 模型预览

**事件系统:**
```javascript
// 发出事件
emit('model-generated', { modelId })  // 模型生成完成
```

### 4.7 3D 渲染模块 (ThreeScene.vue)

**功能职责:**
- Three.js 3D 场景管理
- 模型加载和渲染
- 交互控制 (旋转、缩放、平移)
- 光照和材质管理

**技术实现:**
```javascript
// 核心组件
- WebGL 渲染器
- 透视相机
- 轨道控制器 (OrbitControls)
- GLTF 模型加载器
- 环境光和方向光
- 网格辅助线
- 性能统计 (Stats)
```

**主要功能:**
```javascript
// 场景控制
initThreeJS()           // 初始化 3D 场景
loadModel(path)         // 加载 3D 模型
animate()               // 渲染循环

// 交互功能
zoomIn/Out()            // 缩放控制
resetCamera()           // 重置相机
setLightIntensity()     // 设置光照强度
toggleGrid()            // 切换网格显示
toggleStats()           // 切换统计信息
toggleModelVisibility() // 切换模型可见性
```

**属性接口:**
```javascript
// Props
modelPath: String       // 模型文件路径
lightIntensity: Number   // 光照强度
showGrid: Boolean        // 显示网格
showStats: Boolean       // 显示统计
darkMode: Boolean        // 暗黑模式
```

## 5. 数据管理

### 5.1 状态管理 (Pinia)

**主题状态管理 (stores/theme.js):**
```javascript
// 状态
isDark: Boolean          // 暗黑模式状态

// 方法
toggleTheme()           // 切换主题
applyTheme(dark)        // 应用主题
initTheme()             // 初始化主题
```

**特性:**
- 自动检测系统主题偏好
- 本地存储主题设置
- CSS 变量动态更新
- Element Plus 主题集成

### 5.2 本地存储

**存储项:**
- `theme`: 主题设置 ('dark' | 'light')

## 6. API 接口层

### 6.1 HTTP 客户端配置 (utils/request.js)

**功能特性:**
- 统一的请求/响应拦截器
- 自动 Token 认证
- 错误处理机制
- 完整 URL 支持

**拦截器功能:**
```javascript
// 请求拦截器
- 自动添加 Authorization 头
- 处理完整 URL 请求
- 请求参数预处理

// 响应拦截器
- 统一响应格式处理
- 错误状态码处理
- 数据提取和转换
```

### 6.2 模型生成 API (api/modelGeneration.js)

**接口列表:**

```javascript
uploadImage(file)              // 上传图片
generateModelFromText(data)    // 文字生成模型
generateModelFromImage(data)   // 图片生成模型
getModelHistoryApi()           // 获取模型历史
getModelByIdApi(id)           // 根据ID查询模型
```

**请求格式:**
- 支持 FormData 文件上传
- JSON 格式数据传输
- RESTful API 设计

## 7. 配置管理

### 7.1 环境配置

**开发环境 (.env.development):**
```
VITE_APP_BASE_API=http://localhost:8080/api/
```

**生产环境 (.env.production):**
```
VITE_APP_BASE_API=https://api.gowork.com/api/
```

### 7.2 应用配置 (config/index.js)

```javascript
const config = {
  baseURL: import.meta.env.VITE_APP_BASE_API,
  timeout: 100000,  // 请求超时时间
}
```

## 8. 构建和部署

### 8.1 构建配置 (vite.config.js)

**主要配置:**
- Vue 插件支持
- 路径别名配置
- 开发服务器设置
- 构建优化选项

### 8.2 脚本命令

```json
{
  "dev": "vite",                    // 开发服务器
  "build": "vite build",            // 生产构建
  "preview": "vite preview",        // 预览构建结果
  "lint": "eslint . --fix",         // 代码检查
  "format": "prettier --write src/" // 代码格式化
}
```

## 9. 性能优化

### 9.1 代码分割
- 组件按需导入
- 第三方库分包

### 9.2 资源优化
- 3D 模型压缩
- 静态资源缓存

### 9.3 渲染优化
- Three.js 性能监控

## 10. 开发规范

### 10.1 代码规范
- ESLint + Prettier 统一代码风格
- Vue 3 Composition API 优先
- TypeScript 类型检查 (可选)

### 10.2 组件规范
- 单文件组件 (SFC) 结构
- Props 类型定义
- 事件命名规范
- 样式作用域隔离

### 10.3 提交规范
- 语义化提交信息
- 功能分支开发
- 代码审查流程

---

**文档版本:** v1.0  
**最后更新:** 2025年9月28日  
**维护者:** 开发团队